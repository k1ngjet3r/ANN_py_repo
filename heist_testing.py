import acc
import tensorflow as tf
import numpy as np
from acc import sigmoid, diff_sigmoid

mnist = tf.keras.datasets.mnist
(x_train, y_train), (x_test, y_test) = mnist.load_data()

x_train = x_train.reshape(x_train.shape[0], 784)
x_test = x_test.reshape(x_test.shape[0], 784)

x_train = x_train.astype('float32')
x_test = x_test.astype('float32')

frc = 0.99/255
x_train *= frc
x_train += 0.01
x_test *= frc
x_test += 0.01

desire_list = []
for i in range(10):
    zero = np.zeros(10)
    zero[i] = 1
    desire_list.append(zero)
desire_list = np.array(desire_list)

y_train = np.array([desire_list[i] for i in y_train])
y_test = np.array([desire_list[j] for j in y_test])

training_data = [(y, x) for x, y in zip(x_train, y_train)]
test_data = [(y, x) for x, y in zip(x_test, y_test)]

# Test Run
net = acc.Network([784, 30, 10])
# net.SGD(training_data, 30, 10, 3.0, test_data=test_data)

# net.activations
input_acts = training_data[0][-1]
desire_output = training_data[0][0]
# net.backprop(input_acts, desire_output)
activation = input_acts
activations = [input_acts]
zs = []
d_zs = []
for w, b in zip(net.weights, net.biases):
    z = np.reshape(np.dot(w, activation), (len(b), 1)) + b
    zs.append(z)
    activation = sigmoid(z)
    activations.append(sigmoid(z))
    d_z = diff_sigmoid(z)

error_output = (activations[-1] - desire_output) * d_zs[-1]
errors = [error_output]

print(len(errors))
# training_data[0] = [
#     (array([0., 0., 0., 0., 0., 1., 0., 0., 0., 0.]),
#     array([0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.02164706, 0.07988235, 0.07988235,
#        0.07988235, 0.49917647, 0.538     , 0.68941176, 0.11094117,
#        0.65447056, 1.        , 0.96894115, 0.50305885, 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.1264706 , 0.14976472, 0.37494117, 0.6078823 ,
#        0.67      , 0.9922353 , 0.9922353 , 0.9922353 , 0.9922353 ,
#        0.9922353 , 0.8835294 , 0.6777647 , 0.9922353 , 0.9495294 ,
#        0.7670588 , 0.2584706 , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.2002353 , 0.934     ,
#        0.9922353 , 0.9922353 , 0.9922353 , 0.9922353 , 0.9922353 ,
#        0.9922353 , 0.9922353 , 0.9922353 , 0.9844706 , 0.37105882,
#        0.32835293, 0.32835293, 0.22741178, 0.16141178, 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.07988235, 0.8602353 , 0.9922353 , 0.9922353 ,
#        0.9922353 , 0.9922353 , 0.9922353 , 0.7787059 , 0.71658826,
#        0.96894115, 0.94564706, 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.32058823, 0.6156471 , 0.42541176, 0.9922353 , 0.9922353 ,
#        0.80588233, 0.05270588, 0.01      , 0.17694119, 0.6078823 ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.06435294,
#        0.01388235, 0.6078823 , 0.9922353 , 0.35941175, 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.54964703,
#        0.9922353 , 0.74764705, 0.01776471, 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.05270588, 0.74764705, 0.9922353 ,
#        0.2817647 , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.14588235, 0.94564706, 0.8835294 , 0.6311765 ,
#        0.4292941 , 0.01388235, 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.32447058, 0.9417647 , 0.9922353 , 0.9922353 , 0.472     ,
#        0.10705882, 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.18470588,
#        0.73211765, 0.9922353 , 0.9922353 , 0.5923529 , 0.11482353,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.07211765, 0.37105882,
#        0.98835295, 0.9922353 , 0.736     , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.97670585, 0.9922353 ,
#        0.97670585, 0.2584706 , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.18858825, 0.5147059 ,
#        0.7204706 , 0.9922353 , 0.9922353 , 0.81364703, 0.01776471,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.16141178,
#        0.5845882 , 0.8990588 , 0.9922353 , 0.9922353 , 0.9922353 ,
#        0.98058826, 0.71658826, 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.10317647, 0.45258823, 0.868     , 0.9922353 , 0.9922353 ,
#        0.9922353 , 0.9922353 , 0.79035294, 0.31282353, 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.09929412, 0.2662353 , 0.8369412 , 0.9922353 ,
#        0.9922353 , 0.9922353 , 0.9922353 , 0.7787059 , 0.32447058,
#        0.01776471, 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.07988235, 0.67388237, 0.8602353 ,
#        0.9922353 , 0.9922353 , 0.9922353 , 0.9922353 , 0.7670588 ,
#        0.32058823, 0.04494118, 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.22352941, 0.6777647 ,
#        0.8874118 , 0.9922353 , 0.9922353 , 0.9922353 , 0.9922353 ,
#        0.9572941 , 0.52635294, 0.05270588, 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.538     , 0.9922353 , 0.9922353 , 0.9922353 ,
#        0.83305883, 0.53411764, 0.5224706 , 0.07211765, 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      , 0.01      ,
#        0.01      , 0.01      , 0.01      , 0.01      ], dtype=float32))
# ]
